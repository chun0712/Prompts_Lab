<!DOCTYPE html>
<html lang="zh-TW" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prompt Library | 靈感資料庫</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- 設定新風格：純黑極簡 (Pure Black) -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        // 純黑風格色票
                        pure: {
                            bg: '#000000',      // 純黑背景
                            card: '#0a0a0a',    // 極深灰卡片
                            border: '#262626',  // 微亮邊框
                            hover: '#171717',   // 懸停顏色
                            accent: '#38bdf8',  // 重點色 (天藍，保持科技感)
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'Microsoft JhengHei', 'sans-serif'],
                        mono: ['JetBrains Mono', 'Consolas', 'monospace'],
                    },
                    animation: {
                        'zoom-in': 'zoomIn 0.2s ease-out',
                    },
                    keyframes: {
                        zoomIn: {
                            '0%': { opacity: '0', transform: 'scale(0.98)' },
                            '100%': { opacity: '1', transform: 'scale(1)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #000000; color: #e5e5e5; }
        /* 隱藏捲軸但保留功能 */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body class="bg-pure-bg text-gray-300 font-sans min-h-screen flex flex-col selection:bg-pure-accent selection:text-black">

    <div id="app" class="flex flex-col min-h-screen">

        <!-- Header -->
        <header class="sticky top-0 z-40 bg-black/80 backdrop-blur-md border-b border-pure-border py-4 px-6">
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer" @click="resetSearch">
                    <div class="w-8 h-8 rounded bg-pure-accent flex items-center justify-center shadow-[0_0_15px_rgba(56,189,248,0.3)]">
                        <i class="fa-solid fa-terminal text-black text-sm"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold tracking-wider text-white">PROMPT<span class="text-pure-accent">VAULT</span></h1>
                    </div>
                </div>

                <!-- Search -->
                <div class="relative w-full md:w-1/3">
                    <span class="absolute inset-y-0 left-0 flex items-center pl-3 text-gray-600">
                        <i class="fa-solid fa-search"></i>
                    </span>
                    <input
                        type="text"
                        v-model="searchQuery"
                        placeholder="搜尋資料庫..."
                        class="w-full bg-pure-card border border-pure-border rounded-lg py-2 pl-10 pr-4 text-sm focus:outline-none focus:border-pure-accent focus:ring-1 focus:ring-pure-accent transition-all placeholder-gray-700 text-white"
                    >
                </div>

                <!-- GitHub Database Button (Global) -->
                <a :href="githubJsonEditUrl" target="_blank" class="hidden md:flex items-center gap-2 px-4 py-2 rounded border border-pure-border hover:bg-pure-hover hover:border-gray-500 transition-all text-xs font-mono text-gray-400 hover:text-white">
                    <i class="fa-solid fa-database"></i>
                    <span>管理資料庫</span>
                </a>
            </div>
        </header>

        <!-- Category Nav -->
        <nav class="py-6 px-6 max-w-7xl mx-auto w-full">
            <div class="flex flex-wrap gap-2 justify-center md:justify-start">
                <button
                    @click="currentCategory = 'All'"
                    :class="['px-4 py-1.5 rounded-full text-xs font-medium transition-all duration-300 border',
                    currentCategory === 'All'
                        ? 'bg-pure-accent text-black border-pure-accent font-bold'
                        : 'bg-transparent border-pure-border text-gray-500 hover:text-gray-300 hover:border-gray-500']">
                    全部
                </button>
                <button
                    v-for="cat in uniqueCategories"
                    :key="cat"
                    @click="currentCategory = cat"
                    :class="['px-4 py-1.5 rounded-full text-xs font-medium transition-all duration-300 border',
                    currentCategory === cat
                        ? 'bg-pure-accent text-black border-pure-accent font-bold'
                        : 'bg-transparent border-pure-border text-gray-500 hover:text-gray-300 hover:border-gray-500']">
                    {{ cat }}
                </button>
            </div>
        </nav>

        <!-- Main Grid -->
        <main class="flex-grow px-6 pb-10 max-w-7xl mx-auto w-full">

            <!-- Loading State -->
            <div v-if="isLoading" class="text-center py-20">
                <i class="fa-solid fa-circle-notch fa-spin text-pure-accent text-3xl"></i>
                <p class="mt-4 text-gray-600 text-sm">正在載入資料庫...</p>
            </div>

            <!-- Error State -->
            <div v-else-if="error" class="text-center py-20 text-red-400">
                <i class="fa-solid fa-triangle-exclamation text-3xl mb-2"></i>
                <p>{{ error }}</p>
                <p class="text-xs text-gray-600 mt-2">請確認 GitHub 檔案名稱是否為 data.json</p>
            </div>

            <!-- Content Grid -->
            <div v-else class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">

                <div v-for="item in paginatedItems" :key="item.id"
                     class="group bg-pure-card border border-pure-border rounded-xl overflow-hidden hover:border-pure-accent hover:shadow-[0_0_20px_rgba(56,189,248,0.1)] transition-all duration-300 flex flex-col cursor-pointer"
                     @click="openModal(item)">

                    <!-- Thumbnail -->
                    <div class="relative aspect-video overflow-hidden bg-[#050505]">
                        <img :src="item.image" :alt="item.title" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-80 group-hover:opacity-100">
                        <div class="absolute top-3 right-3">
                            <span class="bg-black/80 backdrop-blur text-[10px] text-pure-accent px-2 py-1 rounded border border-pure-border">
                                {{ item.category }}
                            </span>
                        </div>
                    </div>

                    <!-- Content -->
                    <div class="p-4 flex flex-col flex-grow">
                        <h3 class="text-base font-bold text-white mb-2 group-hover:text-pure-accent transition-colors line-clamp-1">
                            {{ item.title }}
                        </h3>
                        <p class="text-xs text-gray-500 line-clamp-2 mb-4 flex-grow leading-5">
                            {{ item.description }}
                        </p>

                        <div class="mt-auto flex items-center justify-between pt-3 border-t border-pure-border">
                            <span class="text-[10px] text-gray-600 font-mono">
                                #{{ item.id }}
                            </span>
                            <button @click.stop="copyPrompt(item.prompt)" class="text-[10px] bg-pure-hover hover:bg-white hover:text-black text-gray-400 px-3 py-1 rounded border border-pure-border transition-all">
                                複製
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Empty State -->
            <div v-if="!isLoading && !error && filteredItems.length === 0" class="flex flex-col items-center justify-center py-20 text-gray-600">
                <i class="fa-solid fa-ghost text-4xl mb-4 opacity-50"></i>
                <p class="text-sm">沒有找到相關內容</p>
            </div>
        </main>

        <!-- Pagination -->
        <footer class="py-8 border-t border-pure-border bg-black mt-auto">
            <div class="flex justify-center items-center gap-4">
                <button @click="currentPage--" :disabled="currentPage === 1"
                    class="w-8 h-8 rounded flex items-center justify-center bg-pure-card border border-pure-border text-gray-400 hover:bg-white hover:text-black disabled:opacity-30 disabled:cursor-not-allowed transition">
                    <i class="fa-solid fa-chevron-left text-xs"></i>
                </button>
                <span class="text-xs text-gray-500 font-mono">Page {{ currentPage }}</span>
                <button @click="currentPage++" :disabled="currentPage === totalPages"
                    class="w-8 h-8 rounded flex items-center justify-center bg-pure-card border border-pure-border text-gray-400 hover:bg-white hover:text-black disabled:opacity-30 disabled:cursor-not-allowed transition">
                    <i class="fa-solid fa-chevron-right text-xs"></i>
                </button>
            </div>
        </footer>

        <!-- Detail Modal -->
        <div v-if="showModal" class="fixed inset-0 z-50 flex items-center justify-center p-4" @click.self="closeModal">
            <div class="absolute inset-0 bg-black/90 backdrop-blur-sm transition-opacity"></div>

            <div class="relative bg-black border border-pure-border w-full max-w-6xl rounded-xl shadow-2xl overflow-hidden flex flex-col md:flex-row max-h-[90vh] animate-zoom-in ring-1 ring-pure-border">

                <button @click="closeModal" class="absolute top-4 right-4 z-20 bg-black hover:bg-red-900 text-white w-8 h-8 rounded-full border border-pure-border flex items-center justify-center transition">
                    <i class="fa-solid fa-times"></i>
                </button>

                <!-- Left: Image (Lightbox Trigger) -->
                <div class="w-full md:w-1/2 bg-[#050505] flex items-center justify-center relative group cursor-zoom-in border-r border-pure-border" @click="openLightbox">
                    <img :src="selectedItem.image" class="w-full h-full object-contain opacity-80 group-hover:opacity-100 transition duration-300">
                </div>

                <!-- Right: Content -->
                <div class="w-full md:w-1/2 p-8 overflow-y-auto bg-black flex flex-col">
                    <div class="mb-8">
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-xs font-bold text-pure-accent border border-pure-accent px-2 py-0.5 rounded">
                                {{ selectedItem.category }}
                            </span>

                            <!-- ★★★ 這裡就是你要的新增功能：編輯按鈕 ★★★ -->
                            <!-- 如果 JSON 裡有 editUrl，會連去那裡；如果沒有，會連去預設的 JSON 編輯頁 -->
                            <a :href="getEditUrl(selectedItem)" target="_blank"
                               class="ml-auto text-xs text-gray-500 hover:text-white flex items-center gap-1 transition-colors border-b border-transparent hover:border-white pb-0.5">
                                <i class="fa-solid fa-pen-to-square"></i> 編輯此項目
                            </a>
                        </div>

                        <h2 class="text-2xl font-bold text-white mb-4">{{ selectedItem.title }}</h2>
                        <p class="text-gray-400 text-sm leading-relaxed">{{ selectedItem.description }}</p>
                    </div>

                    <div class="flex-grow bg-[#0a0a0a] border border-pure-border rounded-lg p-5 relative group">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-[10px] text-gray-500 font-bold uppercase tracking-widest">Prompt</h4>
                            <button @click="copyPrompt(selectedItem.prompt)" class="text-xs bg-pure-accent text-black font-bold px-3 py-1.5 rounded hover:bg-white transition shadow-[0_0_10px_rgba(56,189,248,0.3)]">
                                複製指令
                            </button>
                        </div>
                        <p class="text-gray-300 font-mono text-sm whitespace-pre-wrap leading-6 select-text">
                            {{ selectedItem.prompt }}
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Fullscreen Lightbox -->
        <div v-if="showLightbox" class="fixed inset-0 z-[60] bg-black flex items-center justify-center animate-zoom-in" @click.self="closeLightbox">
            <button @click="closeLightbox" class="absolute top-5 right-5 text-gray-500 hover:text-white text-2xl transition">
                <i class="fa-solid fa-times"></i>
            </button>
            <img :src="selectedItem.image" class="max-w-full max-h-full object-contain">
        </div>

        <!-- Toast -->
        <div v-if="toastMessage" class="fixed bottom-10 right-10 bg-pure-accent text-black px-6 py-3 rounded shadow-[0_0_20px_rgba(56,189,248,0.4)] font-bold transform transition-all z-[70] flex items-center gap-3 border border-pure-accent">
            <i class="fa-solid fa-check"></i> {{ toastMessage }}
        </div>

    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    // ★★★ 設定區 ★★★
                    githubRepo: 'chun0712/Prompts_Lab', // 你的帳號/儲存庫
                    jsonFileName: 'data.json',          // 確保這裡跟 GitHub 檔名一致

                    items: [], // 這裡留空，等待從 JSON 載入
                    isLoading: true,
                    error: null,
                    searchQuery: '',
                    currentCategory: 'All',
                    currentPage: 1,
                    itemsPerPage: 12,
                    showModal: false,
                    showLightbox: false,
                    selectedItem: {},
                    toastMessage: null
                }
            },
            computed: {
                // 計算 JSON 檔案的編輯網址 (給右上角按鈕用)
                githubJsonEditUrl() {
                    return `https://github.com/${this.githubRepo}/edit/main/${this.jsonFileName}`;
                },
                uniqueCategories() {
                    const categories = new Set(this.items.map(item => item.category));
                    return Array.from(categories);
                },
                filteredItems() {
                    if (!this.items.length) return [];
                    return this.items.filter(item => {
                        const matchesSearch = (item.title || '').toLowerCase().includes(this.searchQuery.toLowerCase()) ||
                                              (item.prompt || '').toLowerCase().includes(this.searchQuery.toLowerCase());
                        const matchesCategory = this.currentCategory === 'All' || item.category === this.currentCategory;
                        return matchesSearch && matchesCategory;
                    });
                },
                paginatedItems() {
                    const start = (this.currentPage - 1) * this.itemsPerPage;
                    const end = start + this.itemsPerPage;
                    return this.filteredItems.slice(start, end);
                },
                totalPages() {
                    return Math.ceil(this.filteredItems.length / this.itemsPerPage) || 1;
                }
            },
            watch: {
                searchQuery() { this.currentPage = 1; },
                currentCategory() { this.currentPage = 1; }
            },
            methods: {
                // ★ 讀取資料的核心功能
                async fetchData() {
                    this.isLoading = true;
                    try {
                        // 加上時間戳記避免瀏覽器快取舊資料
                        const response = await fetch(`./${this.jsonFileName}?t=${new Date().getTime()}`);
                        if (!response.ok) throw new Error('無法找到 data.json，請檢查檔名');
                        this.items = await response.json();
                        this.error = null;
                    } catch (err) {
                        console.error(err);
                        this.error = "無法讀取資料庫，請檢查 GitHub 檔名是否為 data.json";
                    } finally {
                        this.isLoading = false;
                    }
                },
                // ★ 取得個別編輯網址的邏輯
                getEditUrl(item) {
                    // 1. 如果 JSON 裡面有寫 "editUrl" (例如 Issues 連結)，優先使用
                    if (item.editUrl) return item.editUrl;

                    // 2. 如果沒有，預設連去編輯整個 JSON 檔案
                    return this.githubJsonEditUrl;
                },
                openModal(item) {
                    this.selectedItem = item;
                    this.showModal = true;
                    document.body.style.overflow = 'hidden';
                },
                closeModal() {
                    this.showModal = false;
                    document.body.style.overflow = 'auto';
                },
                openLightbox() {
                    this.showLightbox = true;
                },
                closeLightbox() {
                    this.showLightbox = false;
                },
                resetSearch() {
                    this.searchQuery = '';
                    this.currentCategory = 'All';
                },
                copyPrompt(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        this.showToast("已複製！");
                    });
                },
                showToast(msg) {
                    this.toastMessage = msg;
                    setTimeout(() => {
                        this.toastMessage = null;
                    }, 2000);
                }
            },
            mounted() {
                this.fetchData(); // 網頁載入時自動執行
            }
        }).mount('#app');
    </script>
</body>
</html>